{% extends "simple_base.html" %}

{% block title %}KI-Kommentare - yourMoment{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12 d-flex justify-content-between align-items-center flex-wrap gap-3">
        <div>
            <h1 class="mb-1"><i class="bi bi-chat-dots-fill me-2"></i>KI-Kommentare</h1>
            <p class="text-muted mb-0">Prüfe KI-generierte Kommentare und ihre Artikel-Snapshots.</p>
        </div>
        <div class="d-flex gap-2">
            <button id="refreshBtn" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-repeat me-2"></i>Aktualisieren
            </button>
        </div>
    </div>
</div>

<!-- Monitoring Process Details (if viewing process-specific comments) -->
<div id="processDetailsCard" style="display: none;"></div>

<!-- Filters -->
<div class="row mt-4">
    <div class="col-md-3 mb-3">
        <label for="statusFilter" class="form-label">Status</label>
        <select id="statusFilter" class="form-select">
            <option value="ALL" selected>Alle Status</option>
            <option value="generated">Erzeugt</option>
            <option value="posted">Veröffentlicht</option>
            <option value="failed">Fehlgeschlagen</option>
        </select>
    </div>
    <div class="col-md-6 mb-3">
        <label for="searchInput" class="form-label">Suche</label>
        <input type="search" id="searchInput" class="form-control" placeholder="Nach Titel oder Autorin suchen">
    </div>
    <div class="col-md-3 mb-3">
        <label for="limitSelect" class="form-label">Einträge pro Seite</label>
        <select id="limitSelect" class="form-select">
            <option value="20">20</option>
            <option value="50" selected>50</option>
            <option value="100">100</option>
        </select>
    </div>
</div>

<div id="loadingState" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Wird geladen …</span>
    </div>
    <p class="mt-2 text-muted">KI-Kommentare werden geladen …</p>
</div>

<div id="emptyState" class="text-center my-5" style="display: none;">
    <i class="bi bi-chat-dots me-2 text-muted" style="font-size: 4rem;"></i>
    <h3 class="mt-3">Noch keine KI-Kommentare</h3>
    <p class="text-muted">Sobald Überwachungsprozesse KI-Kommentare erzeugen, erscheinen sie hier.</p>
</div>

<div id="commentsList" class="row g-4 mt-4" style="display: none;"></div>
{% endblock %}

{% block extra_js %}
<script type="module">
    import { initCommentsPage } from '{{ url_for("static", path="/js/comments.js") }}';

    // Extract process_id from URL path if present
    const pathMatch = window.location.pathname.match(/\/processes\/([a-f0-9-]+)\/ai-comments/);
    const processId = pathMatch ? pathMatch[1] : null;

    initCommentsPage(processId);
</script>
{% endblock %}
