# ============================================================================
# yourMoment Application Configuration
# ============================================================================
# Copy this file to .env and configure for your environment
# Generate secure keys using the commands in the comments below

# ============================================================================
# ENVIRONMENT
# ============================================================================
# Options: development, testing, production
ENVIRONMENT=development

# Enable debug mode (development only)
DEBUG=false

# ============================================================================
# APPLICATION
# ============================================================================
APP_NAME=yourMoment
APP_VERSION=0.1.0
BASE_URL=http://localhost:8000

# Server configuration
HOST=0.0.0.0
PORT=8000

# ============================================================================
# SECURITY
# ============================================================================
# CRITICAL: Generate new keys for production!
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=insecure-dev-key-change-in-production

# JWT Configuration
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET=default-development-secret
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30

# Encryption Key for sensitive data (credentials, API keys)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# If not set, a key will be auto-generated and saved to .encryption_key
YOURMOMENT_ENCRYPTION_KEY=

# Encryption key file (used if YOURMOMENT_ENCRYPTION_KEY not set)
YOURMOMENT_KEY_FILE=.encryption_key

# Password Policy
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=100
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGITS=true
PASSWORD_REQUIRE_SPECIAL=true

# CORS & Security Headers
ALLOWED_HOSTS=localhost,127.0.0.1
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ============================================================================
# DATABASE
# ============================================================================
# SQLite database file path (relative or absolute)
DB_SQLITE_FILE=yourmoment.db

# Enable SQL query logging (development only)
DB_ECHO=false

# ============================================================================
# CELERY (Background Tasks)
# ============================================================================
# Redis broker and result backend
# For testing, use redis://localhost:6379/1
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Worker concurrency (number of worker processes)
CELERY_WORKER_CONCURRENCY=4

# ============================================================================
# LOGGING
# ============================================================================
# Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# File logging
LOG_FILE_ENABLED=true
LOG_FILE_PATH=logs/app.log
LOG_FILE_MAX_SIZE=10485760  # 10MB in bytes
LOG_FILE_BACKUP_COUNT=5

# Console logging
LOG_CONSOLE_ENABLED=true

# ============================================================================
# WEB SCRAPING (myMoment Integration)
# ============================================================================
# myMoment platform URLs
MYMOMENT_BASE_URL=https://new.mymoment.ch
MYMOMENT_LOGIN_URL=https://new.mymoment.ch/accounts/login/

# Request timeouts and rate limiting
MYMOMENT_TIMEOUT=30
SCRAPING_RATE_LIMIT=2.0  # Requests per second
SCRAPING_BURST_LIMIT=5

# Session management
SESSION_TIMEOUT_MINUTES=60
SESSION_CLEANUP_INTERVAL_MINUTES=30
MAX_CONCURRENT_SESSIONS=5

# Scraping behavior
MAX_ARTICLES_PER_REQUEST=20
RETRY_ATTEMPTS=3
RETRY_DELAY=5.0  # Seconds between retries

# ============================================================================
# MONITORING & COMMENT GENERATION
# ============================================================================
# Default monitoring duration if not specified
DEFAULT_MONITORING_DURATION_MINUTES=60

# Process limits
MAX_MONITORING_PROCESSES=10  # Per user

# Health checks and intervals
PROCESS_HEALTH_CHECK_INTERVAL_SECONDS=30
ARTICLE_DISCOVERY_INTERVAL_SECONDS=60

# Comment generation
COMMENT_GENERATION_TIMEOUT_SECONDS=60
COMMENT_RATE_LIMIT_SECONDS=30  # Minimum seconds between comments

# Required AI comment prefix (German disclosure)
AI_COMMENT_PREFIX=[Dieser Kommentar stammt von einem KI-ChatBot.]

# ============================================================================
# STUDENT BACKUP FEATURE (Optional)
# ============================================================================
# Feature for backing up and versioning student texts from myMoment.
# Requires admin accounts with access to student dashboards.
# Disabled by default - enable only on selected instances.

# Enable/disable the Student Backup feature
STUDENT_BACKUP_ENABLED=false

# Backup interval in minutes (min: 5, max: 1440)
STUDENT_BACKUP_INTERVAL_MINUTES=60

# Maximum students a user can track (min: 1, max: 500)
STUDENT_BACKUP_MAX_TRACKED_STUDENTS_PER_USER=50

# Maximum versions to keep per article (min: 10, max: 1000)
# Oldest versions are soft-deleted when limit is exceeded
STUDENT_BACKUP_MAX_VERSIONS_PER_ARTICLE=100

# Only create new version if content has changed (uses SHA-256 hash)
STUDENT_BACKUP_CONTENT_CHANGES_ONLY=true

# ============================================================================
# PRODUCTION-SPECIFIC SETTINGS
# ============================================================================
# Uncomment and configure for production deployment:

# ENVIRONMENT=production
# SECRET_KEY=<your-production-secret-key>
# JWT_SECRET=<your-production-jwt-secret>
# YOURMOMENT_ENCRYPTION_KEY=<your-production-encryption-key>
# DB_SQLITE_FILE=/var/lib/yourmoment/yourmoment.db
# LOG_FILE_PATH=/var/log/yourmoment/app.log
# ALLOWED_HOSTS=yourdomain.com,www.yourdomain.com
# CORS_ORIGINS=https://yourdomain.com
# BASE_URL=https://yourdomain.com

# ============================================================================
# OPTIONAL: LLM Provider API Keys
# ============================================================================
# These are optional here - users can configure them via the web interface
# Useful for development/testing

# OPENAI_API_KEY=sk-...
# MISTRAL_API_KEY=...

# ============================================================================
# OPTIONAL: Error Tracking
# ============================================================================
# Sentry DSN for error tracking (optional)
# SENTRY_DSN=https://...@sentry.io/...

# ============================================================================
# NOTES
# ============================================================================
# 1. Never commit .env files to version control
# 2. Always generate new secrets for production
# 3. Use absolute paths in production for DB_SQLITE_FILE and LOG_FILE_PATH
# 4. Redis is required only for background workers (Celery)
# 5. The application will validate SECRET_KEY in production mode
# 6. Auto-generated encryption keys are saved to YOURMOMENT_KEY_FILE
